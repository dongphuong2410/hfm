#ifndef __HFM_WIN_OFFSETS_H__
#define __HFM_WIN_OFFSETS_H__

enum win_offsets {
    OBJECT_ATTRIBUTES__OBJECT_NAME,
    OBJECT_ATTRIBUTES__ROOT_DIRECTORY,
    UNICODE_STRING__LENGTH,
    UNICODE_STRING__BUFFER,
    IO_STATUS_BLOCK__INFORMATION,
    IO_STATUS_BLOCK__STATUS,
    KPCR__PRCB,
    KPCR__PRCB_DATA,
    KPRCB__CURRENT_THREAD,
    KTHREAD__PROCESS,
    HANDLE_TABLE__HANDLE_COUNT,
    HANDLE_TABLE__TABLE_CODE,
    HANDLE_TABLE_ENTRY__OBJECT,
    OBJECT_HEADER__BODY,
    OBJECT_HEADER__TYPE_INDEX,
    OBJECT_HEADER__TYPE,
    OBJECT_HEADER_NAME_INFO__NAME,
    FILE_OBJECT__FILE_NAME,
    FILE_OBJECT__DEVICE_OBJECT,
    FILE_OBJECT__SECTION_OBJECT_POINTER,
    OBJECT_TYPE__INDEX,
    EPROCESS__PEB,
    EPROCESS__UNIQUE_PROCESS_ID,
    EPROCESS__ACTIVE_PROCESS_LINKS,
    EPROCESS__OBJECT_TABLE,
    EPROCESS__IMAGE_FILE_NAME,
    DRIVER_OBJECT__DRIVER_NAME,
    PEB__PROCESS_PARAMETERS,
    RTL_USER_PROCESS_PARAMETERS__IMAGE_PATH_NAME,
    SECTION_OBJECT_POINTERS__DATA_SECTION_OBJECT,
    SECTION_OBJECT_POINTERS__IMAGE_SECTION_OBJECT,
    SECTION_OBJECT_POINTERS__SHARED_CACHE_MAP,
    OBJECT_DIRECTORY__HASH_BUCKETS,
    OBJECT_DIRECTORY__LOCK,
    OBJECT_DIRECTORY_ENTRY__OBJECT,
    OBJECT_DIRECTORY_ENTRY__CHAIN_LINK,
    OBJECT_SYMBOLIC_LINK__DOS_DEVICE_DRIVE_INDEX,
    OBJECT_SYMBOLIC_LINK__LINK_TARGET,
    CONTROL_AREA__SEGMENT,
    SEGMENT__CONTROL_AREA,
    SEGMENT__SIZE_OF_SEGMENT,
    SEGMENT__TOTAL_NUMBER_OF_PTES,
    SUBSECTION__CONTROL_AREA,
    SUBSECTION__PTES_IN_SUBSECTION,
    SUBSECTION__STARTING_SECTOR,
    SUBSECTION__SUBSECTION_BASE,
    SUBSECTION__NEXT_SUBSECTION,
    REKALL_OFFSETS_MAX,
    /* Below is extra offsets (hardcode), that is not in rekall file */
    FILE_RENAME_INFORMATION__FILE_NAME_LENGTH,
    FILE_RENAME_INFORMATION__FILE_NAME,
    FILE_DISPOSITION_INFORMATION__DELETE_FILE,
    WIN_OFFSETS_MAX
};

enum win_sizes {
    HANDLE_TABLE_ENTRY,
    CONTROL_AREA,
    FILE_OBJECT,
    OBJECT_HEADER_NAME_INFO,
    OBJECT_HEADER_CREATOR_INFO,
    WIN_SIZES_MAX
};

static const char *win_offset_names[WIN_OFFSETS_MAX][2] = {
    [OBJECT_ATTRIBUTES__OBJECT_NAME] = { "_OBJECT_ATTRIBUTES", "ObjectName"},
    [OBJECT_ATTRIBUTES__ROOT_DIRECTORY] = { "_OBJECT_ATTRIBUTES", "RootDirectory" },
    [UNICODE_STRING__LENGTH] = { "_UNICODE_STRING", "Length" },
    [UNICODE_STRING__BUFFER] = { "_UNICODE_STRING", "Buffer" },
    [IO_STATUS_BLOCK__INFORMATION] = { "_IO_STATUS_BLOCK", "Information" },
    [IO_STATUS_BLOCK__STATUS] = { "_IO_STATUS_BLOCK", "Status" },
    [FILE_RENAME_INFORMATION__FILE_NAME_LENGTH] = { "_FILE_RENAME_INFORMATION", "FileNameLength" },
    [FILE_RENAME_INFORMATION__FILE_NAME] = { "_FILE_RENAME_INFORMATION", "FileName" },
    [FILE_DISPOSITION_INFORMATION__DELETE_FILE] = { "_FILE_DISPOSITION_INFORMATION", "DeleteFile" },
    [KPCR__PRCB] = { "_KPCR", "Prcb" },
    [KPCR__PRCB_DATA] = { "_KPCR", "PrcbData" },
    [KPRCB__CURRENT_THREAD] = { "_KPRCB", "CurrentThread" },
    [KTHREAD__PROCESS] = { "_KTHREAD", "Process" },
    [HANDLE_TABLE__HANDLE_COUNT] = { "_HANDLE_TABLE", "HandleCount" },
    [HANDLE_TABLE__TABLE_CODE] = { "_HANDLE_TABLE", "TableCode" },
    [HANDLE_TABLE_ENTRY__OBJECT] = { "_HANDLE_TABLE_ENTRY", "Object" },
    [OBJECT_HEADER__BODY] = { "_OBJECT_HEADER", "Body" },
    [OBJECT_HEADER__TYPE_INDEX] = { "_OBJECT_HEADER", "TypeIndex" },
    [OBJECT_HEADER__TYPE] = { "_OBJECT_HEADER", "Type" },
    [OBJECT_HEADER_NAME_INFO__NAME] = { "_OBJECT_HEADER_NAME_INFO", "Name" },
    [FILE_OBJECT__FILE_NAME] = { "_FILE_OBJECT", "FileName" },
    [FILE_OBJECT__DEVICE_OBJECT] = { "_FILE_OBJECT", "DeviceObject" },
    [FILE_OBJECT__SECTION_OBJECT_POINTER] = { "_FILE_OBJECT", "SectionObjectPointer" },
    [OBJECT_TYPE__INDEX] = { "_OBJECT_TYPE", "Index" },
    [EPROCESS__PEB] = { "_EPROCESS", "Peb" },
    [EPROCESS__UNIQUE_PROCESS_ID] = { "_EPROCESS", "UniqueProcessId" },
    [EPROCESS__ACTIVE_PROCESS_LINKS] = { "_EPROCESS", "ActiveProcessLinks" },
    [EPROCESS__OBJECT_TABLE] = { "_EPROCESS", "ObjectTable" },
    [EPROCESS__IMAGE_FILE_NAME] = { "_EPROCESS", "ImageFileName" },
    [DRIVER_OBJECT__DRIVER_NAME] = { "_DRIVER_OBJECT", "DriverName" },
    [PEB__PROCESS_PARAMETERS] = { "_PEB", "ProcessParameters" },
    [RTL_USER_PROCESS_PARAMETERS__IMAGE_PATH_NAME] = { "_RTL_USER_PROCESS_PARAMETERS", "ImagePathName" },
    [SECTION_OBJECT_POINTERS__DATA_SECTION_OBJECT] = { "_SECTION_OBJECT_POINTERS", "DataSectionObject" },
    [SECTION_OBJECT_POINTERS__IMAGE_SECTION_OBJECT] = { "_SECTION_OBJECT_POINTERS", "ImageSectionObject" },
    [SECTION_OBJECT_POINTERS__SHARED_CACHE_MAP] = { "_SECTION_OBJECT_POINTERS", "SharedCacheMap" },
    [OBJECT_DIRECTORY__HASH_BUCKETS] = { "_OBJECT_DIRECTORY", "HashBuckets" },
    [OBJECT_DIRECTORY__LOCK] = { "_OBJECT_DIRECTORY", "Lock" },
    [OBJECT_DIRECTORY_ENTRY__OBJECT] = { "_OBJECT_DIRECTORY_ENTRY", "Object" },
    [OBJECT_DIRECTORY_ENTRY__CHAIN_LINK] = { "_OBJECT_DIRECTORY_ENTRY", "ChainLink" },
    [OBJECT_SYMBOLIC_LINK__DOS_DEVICE_DRIVE_INDEX] = { "_OBJECT_SYMBOLIC_LINK", "DosDeviceDriveIndex" },
    [OBJECT_SYMBOLIC_LINK__LINK_TARGET] = { "_OBJECT_SYMBOLIC_LINK", "LinkTarget" },
    [CONTROL_AREA__SEGMENT] = { "_CONTROL_AREA", "Segment" },
    [SEGMENT__CONTROL_AREA] = { "_SEGMENT", "ControlArea" },
    [SEGMENT__SIZE_OF_SEGMENT] = { "_SEGMENT", "SizeOfSegment" },
    [SEGMENT__TOTAL_NUMBER_OF_PTES] = { "_SEGMENT", "TotalNumberOfPtes" },
    [SUBSECTION__CONTROL_AREA] = { "_SUBSECTION", "ControlArea" },
    [SUBSECTION__PTES_IN_SUBSECTION] = { "_SUBSECTION", "PtesInSubsection" },
    [SUBSECTION__STARTING_SECTOR] = { "_SUBSECTION", "StartingSector" },
    [SUBSECTION__SUBSECTION_BASE] = { "_SUBSECTION", "SubsectionBase" },
    [SUBSECTION__NEXT_SUBSECTION] = { "_SUBSECTION", "NextSubsection" }
};

static const char *win_size_names[WIN_SIZES_MAX] = {
    [HANDLE_TABLE_ENTRY] = "_HANDLE_TABLE_ENTRY",
    [CONTROL_AREA] = "_CONTROL_AREA",
    [FILE_OBJECT] = "_FILE_OBJECT",
    [OBJECT_HEADER_NAME_INFO] = "_OBJECT_HEADER_NAME_INFO",
    [OBJECT_HEADER_CREATOR_INFO] = "_OBJECT_HEADER_CREATOR_INFO"
};

#endif
